<!-- Choix du sondage -->
<div *ngIf="!selectedSondageId && !loading">
  <h2>Choisissez un sondage</h2>
  <ul>
    <li *ngFor="let sondage of sondages">
      <button (click)="selectSondage(sondage.id)">{{ sondage.nom }}</button>
    </li>
  </ul>
</div>

<!-- Chargement -->
<div *ngIf="loading">Chargement du quiz...</div>

<!-- Message d'erreur -->
<div *ngIf="errorMessage">{{ errorMessage }}</div>

<!-- Affichage de la question actuelle -->
<div *ngIf="selectedSondageId && !quizFinished && currentQuestion" class="quiz-container">
  <h2>Question {{ currentQuestionIndex + 1 }} : {{ currentQuestion.texteQuestion }}</h2>

  <div class="options">
    <button *ngFor="let option of currentQuestion.options"
            (click)="selectOption(option)">
      {{ option.texteOption }}
    </button>
  </div>
</div>

<!-- Affichage des résultats -->
<div *ngIf="quizFinished" class="result">
  <h2>Merci d'avoir participé !</h2>
  <h3>Résultats</h3>

  <div *ngFor="let question of questions">
    <p><strong>{{ question.texteQuestion }} :</strong></p>

    <ul>
      <li *ngFor="let option of question.options"
          [style.fontWeight]="majoritaireParQuestion[question.id]?.id === option.id ? 'bold' : 'normal'">
        {{ option.texteOption }} -
        {{ getPourcentageVotes(getVotesForOption(question.id, option.id), question.id) }}%
        <span *ngIf="userAnswers[questions.indexOf(question)] === option.id">
          <strong>
            {{ userAnswers[questions.indexOf(question)] === majoritaireParQuestion[question.id]?.id ? '✅ Correct' : '❌ Incorrect' }}
          </strong>
        </span>
      </li>
    </ul>
  </div>

  <button (click)="restartQuiz()">Recommencer</button>
</div>
